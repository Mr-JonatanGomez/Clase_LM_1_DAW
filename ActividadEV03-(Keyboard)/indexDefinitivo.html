<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulario de Registro</title>
    <link rel="stylesheet" href="stylo.css" />
  </head>

  <body>
    <div class="container">
      <div class="header">
        <h2>Formulario de Registro</h2>
      </div>

      <form id="registration-form">
        <input type="text" id="username" placeholder="Nombre de usuario" />
        <div id="username-error" class="error"></div>

        <input type="email" id="email" placeholder="Correo electrónico" />
        <div id="email-error" class="error"></div>

        <input type="password" id="password" placeholder="Contraseña" />
        <div id="password-error" class="error"></div>

        <button id="passInput" type="button" onclick="mostrarPass()">
          Mostrar
        </button>

        <input
          type="password"
          id="confirm-password"
          placeholder="Confirmar contraseña"
        />
        <div id="confirm-password-error" class="error"></div>

        <button type="button" onclick="validateForm()">Registrarse</button>

        <div class="teclado">
          <div class="row">
            <div class="keys" onclick="caracterClicado('1')">1</div>
            <div class="keys" onclick="caracterClicado('2')">2</div>
            <div class="keys" onclick="caracterClicado('3')">3</div>
            <div class="keys" onclick="caracterClicado('4')">4</div>
            <div class="keys" onclick="caracterClicado('5')">5</div>
            <div class="keys" onclick="caracterClicado('6')">6</div>
            <div class="keys" onclick="caracterClicado('7')">7</div>
            <div class="keys" onclick="caracterClicado('8')">8</div>
            <div class="keys" onclick="caracterClicado('9')">9</div>
            <div class="keys" onclick="caracterClicado('0')">0</div>
          </div>
          <div class="row">
            <div class="keys" onclick="caracterClicado('Q')">Q</div>
            <div class="keys" onclick="caracterClicado('W')">W</div>
            <div class="keys" onclick="caracterClicado('E')">E</div>
            <div class="keys" onclick="caracterClicado('R')">R</div>
            <div class="keys" onclick="caracterClicado('T')">T</div>
            <div class="keys" onclick="caracterClicado('Y')">Y</div>
            <div class="keys" onclick="caracterClicado('U')">U</div>
            <div class="keys" onclick="caracterClicado('I')">I</div>
            <div class="keys" onclick="caracterClicado('O')">O</div>
            <div class="keys" onclick="caracterClicado('P')">P</div>
          </div>
          <div class="row">
            <div class="keys" onclick="caracterClicado('A')">A</div>
            <div class="keys" onclick="caracterClicado('S')">S</div>
            <div class="keys" onclick="caracterClicado('D')">D</div>
            <div class="keys" onclick="caracterClicado('F')">F</div>
            <div class="keys" onclick="caracterClicado('G')">G</div>
            <div class="keys" onclick="caracterClicado('H')">H</div>
            <div class="keys" onclick="caracterClicado('J')">J</div>
            <div class="keys" onclick="caracterClicado('K')">K</div>
            <div class="keys" onclick="caracterClicado('L')">L</div>
            <div class="keys" onclick="caracterClicado('Ñ')">Ñ</div>
          </div>
          <div class="row">
            <div class="keys" onclick="caracterClicado('Z')">Z</div>
            <div class="keys" onclick="caracterClicado('X')">X</div>
            <div class="keys" onclick="caracterClicado('C')">C</div>
            <div class="keys" onclick="caracterClicado('V')">V</div>
            <div class="keys" onclick="caracterClicado('B')">B</div>
            <div class="keys" onclick="caracterClicado('N')">N</div>
            <div class="keys" onclick="caracterClicado('M')">M</div>
            <div class="keys" onclick="caracterClicado('.')">.</div>
            <div class="keys" onclick="caracterClicado('-')">-</div>
            <div class="keys" onclick="caracterClicado('_')">_</div>
          </div>
          <div class="row">
            <div class="keys" onclick="caracterClicado('@')">@</div>
            <div class="keys3" onclick="caracterClicado(' ')">SPACE</div>
            <div class="keys2" onclick="caracterClicado('.COM')">.COM</div>
            <div class="keys2" onclick="caracterClicado('.ES')">.ES</div>
            <div class="keys4">DELETE</div>
          </div>
        </div>
      </form>
    </div>

    <script>
      let ultimoFoco = null
      let eventoEnProgreso = false

      function updateLastFocusedInput(event) {
        ultimoFoco = event.target
      }

      function caracterClicado(value) {
        if (ultimoFoco && !eventoEnProgreso) {
          eventoEnProgreso = true // Marcamos que el evento está en progreso para evitar duplicaciones
          ultimoFoco.value += value
          setTimeout(() => {
            eventoEnProgreso = false // Restablecemos el estado del evento después de un breve retraso
          }, 50)
        }
      }

      function borrarUltimoCaracter() {
        if (ultimoFoco && ultimoFoco.value) {
          ultimoFoco.value = ultimoFoco.value.slice(0, -1) // Elimina el último carácter
        }
      }

      document.querySelectorAll("input").forEach((input) => {
        input.addEventListener("focus", updateLastFocusedInput)
      })

      document.querySelectorAll(".keys").forEach((button) => {
        button.removeEventListener("mouseup", caracterClicado) // Eliminar cualquier escucha previa
        button.addEventListener("mouseup", function () {
          caracterClicado(button.innerText) // Corregido para obtener el valor del botón
        })
      })

      document
        .querySelector(".keys4")
        .addEventListener("mouseup", borrarUltimoCaracter)

      // Función para mostrar u ocultar la contraseña
      function mostrarPass() {
        var passInput = document.getElementById("password")
        if (passInput.type === "password") {
          passInput.type = "text"
        } else {
          passInput.type = "password"
        }
      }

      // Función para mostrar u ocultar la contraseña
      function mostrarPass() {
        var passInput = document.getElementById("password")
        if (passInput.type === "password") {
          passInput.type = "text"
        } else {
          passInput.type = "password"
        }
      }

      // Función para mostrar u ocultar la contraseña
      function mostrarPass() {
        var passInput = document.getElementById("password")
        if (passInput.type === "password") {
          passInput.type = "text"
        } else {
          passInput.type = "password"
        }
      }

      // Función para validar el formulario
      function validateForm() {
        const usernameInput = document.getElementById("username")
        const emailInput = document.getElementById("email")
        const passwordInput = document.getElementById("password")
        const confirmPasswordInput = document.getElementById("confirm-password")

        const usernameError = document.getElementById("username-error")
        const emailError = document.getElementById("email-error")
        const passwordError = document.getElementById("password-error")
        const confirmPasswordError = document.getElementById(
          "confirm-password-error"
        )

        usernameError.textContent = ""
        emailError.textContent = ""
        passwordError.textContent = ""
        confirmPasswordError.textContent = ""

        let isValid = true

        if (usernameInput.value === "") {
          usernameError.textContent = "Por favor ingrese un nombre de usuario."
          isValid = false
        }

        if (emailInput.value === "") {
          emailError.textContent = "Por favor ingrese un correo electrónico."
          isValid = false
        } else if (!isValidEmail(emailInput.value)) {
          emailError.textContent =
            "Por favor ingrese un correo electrónico válido."
          isValid = false
        }

        if (passwordInput.value === "") {
          passwordError.textContent = "Por favor ingrese una contraseña."
          isValid = false
        }

        if (confirmPasswordInput.value === "") {
          confirmPasswordError.textContent = "Por favor confirme su contraseña."
          isValid = false
        } else if (confirmPasswordInput.value !== passwordInput.value) {
          confirmPasswordError.textContent = "Las contraseñas no coinciden."
          isValid = false
        }

        if (isValid) {
          alert("¡Formulario enviado correctamente!")
        }
      }

      // Función para validar el formato del correo electrónico
      function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
        return emailRegex.test(email)
      }
    </script>
  </body>
</html>
